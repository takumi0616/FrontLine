# ディープラーニングニューラルネットワークを用いた前線の自動検出

原論文: Automated detection of weather fronts using a deep learning neural network  
誌名: Adv. Stat. Clim. Meteorol. Oceanogr., 5, 147–160, 2019  
DOI: https://doi.org/10.5194/ascmo-5-147-2019  
著作権: © Author(s) 2019. Creative Commons Attribution 4.0 License (CC BY 4.0)

著者:

- James C. Biard, Kenneth E. Kunkel

所属:

- North Carolina Institute for Climate Studies, North Carolina State University, Asheville, North Carolina, 28001, USA

連絡先: James C. Biard (jcbiard@ncsu.edu)

受理・掲載履歴:

- 受理: 2019 年 10 月 2 日
- 掲載: 2019 年 11 月 21 日
- 受理前履歴: 2019 年 3 月 28 日 受付、2019 年 9 月 6 日 改訂

---

## 要旨 (Abstract)

ディープラーニング（DL）手法を用いて、地上気象場から天気前線を自動検出するアルゴリズムを開発した。5 年分（2003–2007）の手動解析前線と地上 5 変数（気温、比湿、海面更正気圧、風ベクトルの 2 成分）に基づき、2 次元畳み込みニューラルネットワーク（2-D CNN）を学習して自動検出アルゴリズム（DL-FRONT）を作成した。2008–2015 年の解析では、北米と隣接海域における手動解析前線のおよそ 90%を DL-FRONT が検出した。極端降水事象に関連する前線を対象とした解析では、重要な天気をもたらす前線に対する検出率がさらに高い可能性が示された。DL-FRONT は北米データセットで学習されており、他地域への拡張性は未検証であるが、温帯低気圧の基本的な前線構造は世界的に適用されてきた。このことから、多くの前線、特に顕著な天気を伴う前線を検出できると期待される。しかし、複雑地形が前線の配向や特性に影響する地域では成功度が低下しうる。

---

## 1 はじめに (Introduction)

前線は、密度の異なる 2 気団の界面（遷移帯）と定義される（American Meteorological Society, 2018）。多くの場合、気温、気圧、湿度、風のコントラストを伴う。温帯低気圧（ETC）の典型構造は、系のポテンシャルエネルギーを供給する異なる気団を分ける前線によって特徴づけられる。

前線は、下部対流圏における水平収束と、それに伴う大規模力学的圧力場に起因する上昇流によって形成されることが多い。この上昇運動は、激しい雷雨から多様な降水まで、広範な有意な気象を伴う。そのため、前線付近は有意な天気の発生確率が高い領域である。Kunkel et al. (2012) は、米国では 5 年再来期待値しきい値を超える極端降水事象の半数超が前線近傍で発生したことを見出した。

天気図による手動の前線同定は多大な労力を要する。これは運用上の自動化に向けた正確な手法開発の強い動機となる。CMIP5/CMIP6 のような気候モデルアンサンブルの出力解析においては、膨大な日数のため手動解析は非現実的であり、自動化は必須である。本研究の直接の動機は、前線に関連する極端降水事象に注目して、CMIP5 シミュレーションにおける前線発生の評価を行う必要性にあった。

前線は一方向に細長い形状を持ち、気象学者はしばしば曲線として表現する。そのため、自動検出法の開発は、ETC 中心や熱帯低気圧（点として近似可能）などの他現象とは異なる課題となる。既存の自動法は種々あるが、本論文ではディープラーニングニューラルネットワーク（DLNN）による新規アプローチを示す。第 2 節で既往研究、第 3 節でアルゴリズム、第 4 節で学習結果と NWS 気象予報士の手動同定との比較、第 5 節で気候学的情報、第 6 節で活用上の留意点を述べる。

---

## 2 既往研究 (Previous work)

自動前線検出の多くは、地上場のある物理量に対しラプラシアンを計算し、その高値領域（空間勾配の急変領域）を前線として同定する。多くは熱力学的要素を含む。Hewson (1998)、Berry et al. (2011)、Catto et al. (2012) は湿球ポテンシャル温度 θw を用い、Jenkner et al. (2010)、Schemm et al. (2015) は相当温位 θe を用いた。水蒸気と温度の共変性から、θw と θe の選択で大差が出るかは一義的ではない。Simmonds et al. (2012)、Schemm et al. (2015)、Huang et al. (2017) は地上風のみでの検出も検討し、成功を示したが、密度勾配のない領域が前線と誤認されうる。Parfitt et al. (2017) は相対渦度 ζ と温位 θ の積による指標を提案し、風向変化と温度変化の双方を必要とする厳格な定義とした。

これらの研究では、解析に用いる単一（あるいは合成）パラメータの選択が必要であり、他の場の情報を柔軟に取り込むことが難しい。Wong et al. (2008) の遺伝的アルゴリズムは多変量を扱えるが、実際には限られた変数選択が必要であった。さらに、多くの研究で評価は少数事例の定性的比較に留まり、定量指標の提示は乏しかった。

Sanders and Hoffman (2002) は、天気図に描かれる前線と傾圧帯の区別を議論し、前者が必ずしも密度差で特徴づけられないことを示した。Sanders (2005) は密度差のない境界を前線と呼ぶべきでないと主張する一方、運用現場では風向変化や気圧の谷に基づき温度差がなくとも前線が描かれることがある。

---

## 3 手法 (Methods)

### 3.1 ディープラーニングニューラルネットワーク（DLNN）

運用解析では、前線は気圧の谷と気温/湿度の勾配、風向のシフトといった準線状・局在的特徴の空間的一致から視覚的に同定され、寒冷・温暖・停滞・閉塞に分類される（Stull, 2015）。本 DLNN はこの視覚的同定を模倣する。

目標は、画像全体の識別ではなく、格子の各セルが特定の前線種（寒冷・温暖・停滞・閉塞）または「なし」に属する確率を推定すること。「なし」は前線域にないセルの陽性同定を可能にする。これを基に、気象官が描く前線線に類似する線形状を抽出する。

DL は入力から多層の非線形変換で特徴を抽出する（Goodfellow et al., 2016）。本研究の DL-FRONT は、2-D 畳み込み層、ReLU 層、2-D ドロップアウト層、2-D ゼロパディング層、ソフトマックス層からなる。

- 2-D 畳み込み層は、入力特徴写像 Il とフィルタ fkl の畳み込みとバイアス bk で出力 Ok を生成する:
  Ok = bk + Σ\_{l=1..L} fkl ∘ Il … (1)
- ReLU は要素ごとに非負部分を通し、負は 0 にする:
  Okij = 0 (Ikij<0), Okij = Ikij (Ikij≥0) … (2)
- ソフトマックスは各セルの特徴ベクトルに適用し確率に正規化する:
  Okij = exp(Ikij) / Σ\_{l=1..L} exp(Ilij) … (3)
- 2-D ドロップアウトは学習時にランダムに一部特徴写像を 0 にし過学習を抑制する（Hinton et al., 2012）。
- ゼロパディングは畳み込みでの空間縮小を補正する。

学習はカテゴリカルクロスエントロピー損失を用いる:
H(p,t) = − Σ*{i=1..I} Σ*{c=1..C} wc log(pic) tic … (4)
ここで、p は予測確率ベクトル集合、t はラベル、wc はカテゴリ重み。データの約 88%が「なし」であるため、その重みを 0.35、他は 1.0 とすることで「なし」に損失が支配されるのを抑えた。最適化は Adam（Kingma and Ba, 2015）、学習率は 0.0001。

実装は Python、numpy、Keras（TensorFlow / Theano バックエンド）、scikit-learn で k-fold CV とハイパラ探索を用いた。5×5 カーネルの 2-D 畳み込みを基本とし、各種ハイパラの探索後、最良の検証性能を示したネットワークは以下。

ネットワーク（図 1 の概念図）:

- 入力: 5 特徴写像（2 m 気温、2 m 比湿、海面更正気圧、10 m 東西風 u、10 m 南北風 v）。MERRA-2 の 3 時間ごと瞬間値、1° 格子、領域: 10–77°N, 171–31°W。2003–2015 で 37,984 時刻。
- 第 1〜3 層: 各層がゼロパディング → 5×5 畳み込み（80 フィルタ）→ ReLU → 50%ドロップアウト。空間サイズは維持、特徴写像 80。
- 第 4 層: ゼロパディング → 5×5 畳み込み（5 フィルタ）→ ソフトマックス。出力は 5 カテゴリ（寒冷・温暖・停滞・閉塞・なし）の確率マップ。

### 3.2 前線ポリライン抽出

DL-FRONT の出力確率場から前線線を抽出するため、numpy と scikit-image を用いて各種前線タイプの「稜線」を追跡し、緯度経度のポリラインへ簡約する。

手順:

1. one-hot 化（各セルで最尤カテゴリを 1、他 0）と「any front」格子（寒冷・温暖・停滞・閉塞の最大確率、最尤が「なし」のセルは 0）を作成。
2. 「any front」格子の発散を計算し、−0.005 より大きい値を 0 にクリップ。非ゼロ位置のマスクを生成。細い帯域と中心最小線が得られる。
3. scikit-image morphology.medial_axis でマスクをスケルトン化（幅 1 セル）。
4. one-hot で前線タイプごとにスケルトンと発散格子を分割。各タイプについて、connected components を抽出し、端点間の最小コスト経路（graph.MCP）を発散格子上で算出してラスターポリラインを得る。最小頂点数のポリラインへ簡約し、緯度経度へ変換。
5. 各時刻のポリラインを JSON に出力（時刻、前線タイプ別）。

### 3.3 ラベルデータセット

NWS の Coded Surface Bulletin（CSB）メッセージ（National Weather Service, 2019）から、気圧中心、前線、トラフの緯度経度ポリラインを取得（2003–2015 で 37,709 件）。MERRA-2 の格子に合わせて各タイプごとにラスタ化。前線は幅 3°（3 格子）で描画し、前線の有限幅と位置の許容誤差を考慮。訓練・検証・評価は、CSB で年間 40 回以上の前線通過がある北米周辺領域（図 2 のマスク）に制限。

初期開発では NARR（Mesinger et al., 2006, 32 km）を用いたが、約 96 km（3 格子）に粗視化した方が性能が高く、MERRA-2 での学習では検証損失・精度がさらに良好であったため MERRA-2 に切替。分析の一部では北米中心の NARR 投影格子を継続使用。

### 3.4 前線通過頻度の算定

格子点ごとの前線通過日数（front days）を気候学的比較の実用指標として用いる。3 時間ステップのポリラインから、約 96 km 格子（NARR の 3 格子）で各時刻に交差セルをカウント。遅い/停滞前線による過大カウントを避けるため、同一セルでカウント後 24 時間（7 ステップ）はブランキング。月間のカウントを時刻数で割り 8 を掛けて（1 日=8 ステップ）日あたり通過率に換算。全前線の合算も算定。季節別（DJF, MAM, JJA, SON）も同様。

3 時間での前線移動により隣接セルを飛び越えることがあり、幅 1 セルのラスタ化では隙間が生じ、空間ストライプを生むため、ラスタ幅を 3 セルに拡大して解消。ブランキングで過大カウントは抑制。

---

## 4 結果 (Results)

### 4.1 学習

最終 DL-FRONT は、2003–2007（14,353 時刻）を 3 分割クロスバリデーションで学習。各 fold は 9,568 時刻（2/3）をランダムに時系列シャッフルして使用。損失が 100 エポック改善しない時点で停止し、各 fold は 1141/1142/1136 エポックで終了。学習損失・精度（図 3）は過学習の兆候が少なく、カテゴリ精度は約 90%に収束。最良（fold 3）の重みを採用し、2003–2015 の全 37,984 時刻に適用して確率場を生成。

代表時刻（2009-08-01 12UTC, 学習外期間）の出力例（図 4）は、CSB 前線と概ね整合。空間位置の不一致やタイプの相違も見られるが、DL-FRONT は NWS の解析範囲外（図 2）の太平洋やバフィン島でも前線を同定する一方、CSB の太平洋岸寒冷前線や西部山岳の停滞前線が欠落する場合もある。

### 4.2 評価指標 (Metrics)

#### 4.2.1 実際/予測セル数

表 1 に、マスク領域内の各カテゴリのセル割合（CSB と DL-FRONT、2003–2007・2008–2015・合算）を示す。CSB の前線セル割合は 12.3〜12.6%、DL-FRONT は 11.7〜11.9%で僅かな過少検出。タイプ別割合は概ね類似するが、温暖前線が DL-FRONT で過少。全体として約 88%が「なし」で非対称。

（表 1 抜粋・割合, 合算 2003–2015）

- CSB: 寒冷 3.85%, 温暖 1.75%, 停滞 5.27%, 閉塞 1.60%, いずれか 12.47%, なし 87.53%
- DL-FRONT: 寒冷 3.77%, 温暖 1.16%, 停滞 5.24%, 閉塞 1.59%, いずれか 11.77%, なし 88.23%

#### 4.2.2 カテゴリ精度

全 5 カテゴリと、2 カテゴリ（前線/なし）に集約した場合のカテゴリ精度（表 2）では、学習・検証期間で同程度の性能。非対称性により、全セルを「なし」とするだけで約 87.7%の見かけ精度を達成し得るが、表 1 のタイプ別割合はそのような崩壊ではないことを示す。

（表 2 抜粋）

- 2008–2015: 全カテゴリ 88.00%, 前線/なし 89.85%
- 2003–2007: 全カテゴリ 88.53%, 前線/なし 90.15%

#### 4.2.3 混同行列

全 5 カテゴリの混同行列（表 3a,b）と、前線/なしの混同行列（表 4a,b）を提示。最も顕著な誤りは、実際は前線セルを「なし」と判定する誤検出で、正検出と同程度に発生。ただし、これは前線の位置のズレに起因する場合が多い。タイプ誤分類は、停滞と温暖、停滞と寒冷の混同が多い。

（表 4 2008–2015 前線/なし, % of total）

- 実前線 → 予前線 7.06%, 実前線 → 予なし 5.52%, 実なし → 予前線 4.63%, 実なし → 予なし 82.79%

#### 4.2.4 ROC および Precision–Recall

前線/なしで ROC 曲線と AUC（図 5a）、Precision–Recall（図 5b）を算出。しきい値 1.0（デフォルト）は保守的な位置にあり、低 FPR で高 TPR を実現。AUC=0.90 は良好な性能を示す。Precision–Recall でも学習・検証で類似し、しきい値 1.0 は精度と再現率の双方が高い領域にある。

---

## 5 気候学的解析 (Climatological analysis)

DL-FRONT 確率から抽出したポリラインを用い、CSB と DL-FRONT の両方で、NARR 投影の 96×96 km 格子上で月・季節の前線通過率を算出し、2003–2015 の気候値を作成。CONUS 中心の矩形 ROI 上での季節別マップ（図 6）は類似性が高い。

図 7 の散布図比較では、各季節でピアソン相関 r>0.94。±2σ の差の範囲は概ね週あたり 0.5 回で、CSB の典型値（週 2–3 回）に対し、地点によっては 20%以上の差がある。

Kunkel et al. (2012) の前線起因の極端降水 3191 事象（1980–2013）と DL-FRONT 前線（MERRA-2）との距離を算定したところ、累積分布（図 8）で約 97%が 200 km 以内に位置。季節依存も小。定性的判断に基づく既往研究との比較ではあるが、「天気を生み出す前線」に対する DL-FRONT の同定有効性を示唆。

CONUS ROI の月別前線/なし通過率の空間平均の比較（図 9）でも、双方は ±1σ の範囲で一致。月別異常の時系列（図 10）は r=0.70（p<0.01）で良い一致。2008–2010 に低く、その前後で高い。CSB には有意な上昇傾向が見られ、MERRA-2 はほぼゼロ傾向。2012 年以降、CSB が MERRA-2 より高い月が多いが、原因解明は本研究範囲外。

---

## 6 議論と結論 (Discussion and conclusions)

5 年の手動解析前線（2003–2007）で学習した 2-D CNN により、地上 5 変数（気温、比湿、海面更正気圧、10 m 風 u,v）から前線自動検出アルゴリズム DL-FRONT を開発した。2003–2015 の解析で、北米と隣接海域において手動前線の約 90%を検出。極端降水に関連する前線のサブセットでは検出率がより高い可能性があり、本アルゴリズムは当該目的に適していると判断される。

DL の利点は、入力場を追加しやすい拡張性（学習は高コストだが、問題設定の本質的再構成を要しない）、将来の DL の進展を取り込めること。一方、方程式形で物理理解を組み込むわけではないため、原理的診断の困難さが欠点。

DL-FRONT は北米データで学習しており、全球適用は未検証。ただし、温帯低気圧の前線構造は全球的であり、有意な天気を伴う前線の多くは検出可能と期待される。地形が前線の配向等に影響する地域では性能低下の懸念がある。ロッキー山脈前縁のような地形影響は学習データに含まれ良好に検出されたが、他地域での一般性は未知。静的標高場の追加も試したが学習改善はなく断念した。

Sanders (2005) は密度差のない特徴を前線と呼ぶことに否定的であるが、CSB にはそのようなケースが含まれる可能性があり、DL-FRONT の入力に風・気圧を含むため、同様の境界を検出しうる。

他手法との系統的比較は本研究範囲外であるが、手法の多様化を踏まえ、相互比較プロジェクトが有意義と考えられる。障壁は、全球をカバーする整備されたラベルデータの欠如であり、北米に限れば CSB が（限界に留意しつつ）準拠データとなりうる。

---

## データ提供 (Data availability)

- MERRA-2 データ: NASA GES DISC (https://disc.gsfc.nasa.gov/)。用いたサブセットは inst1_2d_asm_Nx V5.12.4（QV2M, SLP, T2M, U10M, V10M）を 1°×1° へバイキュービック補間。
- CSB データ: Zenodo
  - ASCII: https://doi.org/10.5281/zenodo.2642801
  - JSON: https://doi.org/10.5281/zenodo.2646544 (Biard, 2019a)
  - netCDF ラスタ格子: https://doi.org/10.5281/zenodo.2651361 (Biard, 2019b)
  - ライセンス: CC BY-SA 4.0
- DL-FRONT の適用生成物（MERRA-2 上）: Zenodo
  - 確率格子・one-hot（netCDF）: https://doi.org/10.5281/zenodo.2641072 (Biard and Kunkel, 2019a)
  - ポリライン（JSON）: https://doi.org/10.5281/zenodo.2669180 (Biard and Kunkel, 2019b)
  - ポリラインのラスタ格子（netCDF）: https://doi.org/10.5281/zenodo.2669505 (Biard and Kunkel, 2019c)
  - ライセンス: CC BY-NC-SA 4.0
- 付随成果物（表計算、2009 年の CSB ラスタと DL-FRONT 確率の並列動画など）: https://doi.org/10.5281/zenodo.2712481 (Biard and Kunkel, 2019d)、CC BY-NC-SA 4.0

---

## 著者貢献 (Author contributions)

研究目標（自動前線境界検出）の立案と科学的監督は KEK（Michael Wehner の支援を受けた）。ソフトウェア開発、データ処理・解析・可視化は JCB。論文は JCB と KEK が共同執筆。

## 利益相反 (Competing interests)

著者は利益相反がないことを表明する。

## 謝辞 (Acknowledgements)

本研究は、UCAR/Unidata の netCDF ソフトウェア（https://doi.org/10.5065/D6H70CW6）の恩恵を受けた。Evan Racah、Mr Prahbat、Michael Wehner との議論、Scott Stevens の支援に謝意を表する。

## 研究費 (Financial support)

戦略環境研究開発プログラム（SERDP, grant W912HQ-15-C-0010）および NOAA（CICS-NC, cooperative agreement NA14NES432003）の支援を受けた。

## 査読 (Review statement)

編集: William Hsieh。査読: Orhun Aydin および匿名査読者 1 名。

---

## 参考文献 (References)

本文中に引用された参考文献（抜粋、原題のまま）:

- Abadi, M., et al. (2015). TensorFlow: …
- American Meteorological Society (2018). Glossary: Fronts.
- Biard, J. C. (2019a,b); Biard and Kunkel (2019a–d) …
- Berry, G., Reeder, M. J., Jakob, C. (2011). A global climatology of atmospheric fronts.
- Catto, J. L., et al. (2012). Relating global precipitation to atmospheric fronts.
- Chollet, F. (2015). Keras.
- Cybenko, G. (1989). Approximation by superpositions…
- Deng, L., Yu, D. (2014). Deep learning: methods and applications.
- Gelaro, R., et al. (2017). MERRA-2.
- Global Modeling and Assimilation Office (2019). MERRA-2 inst1_2d_asm_Nx.
- Goodfellow, I., et al. (2016). Deep Learning.
- Hewson, T. D. (1998). Objective Fronts.
- Hinton, G. E., et al. (2012). Improving neural networks by preventing co-adaptation…
- Huang, Y., et al. (2017). Objective Identification of Trough Lines…
- Jenkner, J., et al. (2010). Detection and climatology of fronts…
- Kingma, D., Ba, J. (2015). Adam…
- Kolmogorov, A. N. (1957). Representation of continuous functions…
- Kunkel, K. E., et al. (2012). Meteorological causes of secular variations…
- Mesinger, F., et al. (2006). North American Regional Reanalysis.
- National Weather Service (2019). Coded Surface Bulletin.
- Neilsen, M. A. (2015). Neural Networks and Deep Learning.
- Parfitt, R., et al. (2017). A simple diagnostic for detection of atmospheric fronts.
- Pedregosa, F., et al. (2011). Scikit-learn.
- Sanders, F., Hoffman, E. G. (2002). A Climatology of Surface Baroclinic Zones.
- Sanders, F. (2005). Real Front or Baroclinic Trough?
- Schemm, S., et al. (2015). Extratropical fronts in the lower troposphere…
- Simmonds, I., et al. (2012). Southern Hemisphere mobile fronts…
- Stull, R. (2015). Practical Meteorology.
- Theano Development Team (2016). Theano…
- van der Walt, S., et al. (2011, 2014). NumPy; scikit-image.
- Wong, K. Y., et al. (2008). Automatic identification of weather systems…

（注）図・表番号（図 1–10、表 1–4）は本文中で参照されるが、本ファイルはテキスト翻訳であり、画像自体は含まない。図表の記述内容は本文中に反映した。
